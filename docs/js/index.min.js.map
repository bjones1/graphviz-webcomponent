{"version":3,"file":"index.min.js","sources":["../src/graph.js","../src/codejar/codejar.js","../src/prism/prism-core.js","../src/prism/prism-line-numbers.js","../src/prism/prism-match-braces.js","../src/prism/prism-graphviz.js","../src/script-editor.js"],"sourcesContent":["const graphKey = Symbol('graph')\nconst scaleKey = Symbol('scale')\nconst { delayWorkerLoading } = window.graphvizWebComponent || {}\nlet renderer, rendererUrl, wasmFolder\n\nif (!delayWorkerLoading) getRenderer()\n\nfunction ensureConfiguration () {\n  if (!rendererUrl) {\n    ({\n      rendererUrl = 'https://unpkg.com/graphviz-webcomponent@0.4.2/dist/renderer.min.js',\n      wasmFolder = 'https://unpkg.com/@hpcc-js/wasm@0.3.14/dist'\n    } = window.graphvizWebComponent || {})\n  }\n}\n\nfunction getRenderer () {\n  if (!renderer) {\n    ensureConfiguration()\n    renderer = new Worker(rendererUrl)\n  }\n  return renderer\n}\n\nfunction requestRendering (element, script, receiveResult) {\n  const renderer = getRenderer()\n  renderer.addEventListener('message', receiveResult)\n  const localWasmFolder = element.getAttribute('wasmFolder')\n  if (localWasmFolder) {\n    console.warn('Stop using the deprecated \"wasmFolder\" attribute. Set the global variable \"graphvizWebComponent.wasmFolder\" instead.')\n    wasmFolder = localWasmFolder\n  } else {\n    ensureConfiguration()\n  }\n  renderer.postMessage({ script: script || element.graph, wasmFolder })\n  wasmFolder = undefined\n}\n\nfunction closeRendering (receiveResult) {\n  const renderer = getRenderer()\n  renderer.removeEventListener('message', receiveResult)\n}\n\nfunction triggerEvent (element, type, detail) {\n  element.dispatchEvent(new CustomEvent(type, { detail }))\n}\n\nfunction applyScale (element) {\n  const svg = element.shadowRoot.children[0]\n  const scale = element.scale\n  if (svg) {\n    if (scale) {\n      svg.style.transform = `scale(${scale})`\n      svg.style.transformOrigin = 'top left'\n    } else {\n      svg.style.transform = ''\n      svg.style.transformOrigin = ''\n    }\n  }\n}\n\nfunction showImage (element, svg) {\n  element.shadowRoot.innerHTML = svg\n  applyScale(element)\n  triggerEvent(element, 'render', svg)\n}\n\nfunction showError (element, error) {\n  console.error('Graphviz failed:', error)\n  element.shadowRoot.innerHTML = error.message\n  return triggerEvent(element, 'error', error)\n}\n\nfunction updateGraph (element) {\n  element.shadowRoot.innerHTML = ''\n  if (!element.graph) return\n  requestRendering(element, undefined, receiveResult)\n\n  function receiveResult ({ data }) {\n    const { svg, error } = data\n    closeRendering(receiveResult)\n    if (error) {\n      error.message = error.message.trim()\n      return showError(element, error)\n    }\n    showImage(element, svg)\n  }\n}\n\nfunction tryUpdateGraph (element, script) {\n  return new Promise((resolve, reject) => {\n    if (!script) {\n      element[graphKey] = ''\n      element.shadowRoot.innerHTML = ''\n      return resolve()\n    }\n    requestRendering(element, script, receiveResult)\n\n    function receiveResult ({ data }) {\n      const { svg, error } = data\n      closeRendering(receiveResult)\n      if (error) return reject(error)\n      element[graphKey] = script\n      showImage(element, svg)\n      resolve(svg)\n    }\n  })\n}\n\nclass GraphvizGraphElement extends HTMLElement {\n  constructor () {\n    super()\n    this.attachShadow({ mode: 'open' })\n  }\n\n  get graph () { return this[graphKey] }\n  set graph (value) { this.setAttribute('graph', value) }\n\n  get scale () { return this[scaleKey] }\n  set scale (value) { this.setAttribute('scale', value) }\n\n  attributeChangedCallback (name, oldValue, newValue) {\n    switch (name) {\n      case 'graph':\n        this[graphKey] = newValue\n        updateGraph(this)\n        break\n      case 'scale':\n        this[scaleKey] = newValue\n        applyScale(this)\n    }\n  }\n\n  tryGraph (graph) {\n    return tryUpdateGraph(this, graph)\n  }\n\n  static get observedAttributes () { return ['graph', 'scale'] }\n}\n\ncustomElements.define('graphviz-graph', GraphvizGraphElement)\n","export function CodeJar(editor, highlight, opt = {}) {\n    const options = Object.assign({ tab: \"\\t\", ownerRoot: window }, opt);\n    // only Chrome supports shadowRoot.getSelection\n    if (typeof options.ownerRoot.getSelection !== 'function') {\n        options.ownerRoot = options.ownerRoot.ownerDocument;\n        if (typeof options.ownerRoot.getSelection !== 'function') {\n            throw new Error('Impossible to access text selections.');\n        }\n    }\n    let listeners = [];\n    let history = [];\n    let at = -1;\n    let focus = false;\n    let callback;\n    let prev; // code content prior keydown event\n    let isFirefox = navigator.userAgent.toLowerCase().indexOf(\"firefox\") > -1;\n    editor.setAttribute(\"contentEditable\", isFirefox ? \"true\" : \"plaintext-only\");\n    editor.setAttribute(\"spellcheck\", \"false\");\n    editor.style.outline = \"none\";\n    editor.style.overflowWrap = \"break-word\";\n    editor.style.overflowY = \"auto\";\n    editor.style.resize = \"vertical\";\n    editor.style.whiteSpace = \"pre-wrap\";\n    highlight(editor);\n    const debounceHighlight = debounce(() => {\n        const pos = save();\n        highlight(editor);\n        restore(pos);\n    }, 30);\n    let recording = false;\n    const shouldRecord = (event) => {\n        return !isUndo(event) && !isRedo(event)\n            && event.key !== \"Meta\"\n            && event.key !== \"Control\"\n            && event.key !== \"Alt\"\n            && !event.key.startsWith(\"Arrow\");\n    };\n    const debounceRecordHistory = debounce((event) => {\n        if (shouldRecord(event)) {\n            recordHistory();\n            recording = false;\n        }\n    }, 300);\n    const on = (type, fn) => {\n        listeners.push([type, fn]);\n        editor.addEventListener(type, fn);\n    };\n    on(\"keydown\", event => {\n        if (event.defaultPrevented)\n            return;\n        prev = toString();\n        handleNewLine(event);\n        handleTabCharacters(event);\n        handleJumpToBeginningOfLine(event);\n        handleSelfClosingCharacters(event);\n        handleUndoRedo(event);\n        if (shouldRecord(event) && !recording) {\n            recordHistory();\n            recording = true;\n        }\n    });\n    on(\"keyup\", event => {\n        if (event.defaultPrevented)\n            return;\n        if (event.isComposing)\n            return;\n        if (prev !== toString())\n            debounceHighlight();\n        debounceRecordHistory(event);\n        if (callback)\n            callback(toString());\n    });\n    on(\"focus\", _event => {\n        focus = true;\n    });\n    on(\"blur\", _event => {\n        focus = false;\n    });\n    on(\"paste\", event => {\n        recordHistory();\n        handlePaste(event);\n        recordHistory();\n        if (callback)\n            callback(toString());\n    });\n    function save() {\n        const s = options.ownerRoot.getSelection();\n        const pos = { start: 0, end: 0, dir: undefined };\n        visit(editor, el => {\n            if (el === s.anchorNode && el === s.focusNode) {\n                pos.start += s.anchorOffset;\n                pos.end += s.focusOffset;\n                pos.dir = s.anchorOffset <= s.focusOffset ? \"->\" : \"<-\";\n                return \"stop\";\n            }\n            if (el === s.anchorNode) {\n                pos.start += s.anchorOffset;\n                if (!pos.dir) {\n                    pos.dir = \"->\";\n                }\n                else {\n                    return \"stop\";\n                }\n            }\n            else if (el === s.focusNode) {\n                pos.end += s.focusOffset;\n                if (!pos.dir) {\n                    pos.dir = \"<-\";\n                }\n                else {\n                    return \"stop\";\n                }\n            }\n            if (el.nodeType === Node.TEXT_NODE) {\n                if (pos.dir != \"->\")\n                    pos.start += el.nodeValue.length;\n                if (pos.dir != \"<-\")\n                    pos.end += el.nodeValue.length;\n            }\n        });\n        return pos;\n    }\n    function restore(pos) {\n        const s = options.ownerRoot.getSelection();\n        let startNode, startOffset = 0;\n        let endNode, endOffset = 0;\n        if (!pos.dir)\n            pos.dir = \"->\";\n        if (pos.start < 0)\n            pos.start = 0;\n        if (pos.end < 0)\n            pos.end = 0;\n        // Flip start and end if the direction reversed\n        if (pos.dir == \"<-\") {\n            const { start, end } = pos;\n            pos.start = end;\n            pos.end = start;\n        }\n        let current = 0;\n        visit(editor, el => {\n            if (el.nodeType !== Node.TEXT_NODE)\n                return;\n            const len = (el.nodeValue || \"\").length;\n            if (current + len >= pos.start) {\n                if (!startNode) {\n                    startNode = el;\n                    startOffset = pos.start - current;\n                }\n                if (current + len >= pos.end) {\n                    endNode = el;\n                    endOffset = pos.end - current;\n                    return \"stop\";\n                }\n            }\n            current += len;\n        });\n        // If everything deleted place cursor at editor\n        if (!startNode)\n            startNode = editor;\n        if (!endNode)\n            endNode = editor;\n        // Flip back the selection\n        if (pos.dir == \"<-\") {\n            [startNode, startOffset, endNode, endOffset] = [endNode, endOffset, startNode, startOffset];\n        }\n        s.setBaseAndExtent(startNode, startOffset, endNode, endOffset);\n    }\n    function beforeCursor() {\n        const s = options.ownerRoot.getSelection();\n        const r0 = s.getRangeAt(0);\n        const r = document.createRange();\n        r.selectNodeContents(editor);\n        r.setEnd(r0.startContainer, r0.startOffset);\n        return r.toString();\n    }\n    function afterCursor() {\n        const s = options.ownerRoot.getSelection();\n        const r0 = s.getRangeAt(0);\n        const r = document.createRange();\n        r.selectNodeContents(editor);\n        r.setStart(r0.endContainer, r0.endOffset);\n        return r.toString();\n    }\n    function handleNewLine(event) {\n        if (event.key === \"Enter\") {\n            const before = beforeCursor();\n            const after = afterCursor();\n            let [padding] = findPadding(before);\n            let newLinePadding = padding;\n            // If last symbol is \"{\" ident new line\n            if (before[before.length - 1] === \"{\") {\n                newLinePadding += options.tab;\n            }\n            if (isFirefox) {\n                preventDefault(event);\n                insert(\"\\n\" + newLinePadding);\n            }\n            else {\n                // Normal browsers\n                if (newLinePadding.length > 0) {\n                    preventDefault(event);\n                    insert(\"\\n\" + newLinePadding);\n                }\n            }\n            // Place adjacent \"}\" on next line\n            if (newLinePadding !== padding && after[0] === \"}\") {\n                const pos = save();\n                insert(\"\\n\" + padding);\n                restore(pos);\n            }\n        }\n    }\n    function handleSelfClosingCharacters(event) {\n        const open = `([{'\"`;\n        const close = `)]}'\"`;\n        const codeAfter = afterCursor();\n        if (close.includes(event.key) && codeAfter.substr(0, 1) === event.key) {\n            const pos = save();\n            preventDefault(event);\n            pos.start = ++pos.end;\n            restore(pos);\n        }\n        else if (open.includes(event.key)) {\n            const pos = save();\n            preventDefault(event);\n            const text = event.key + close[open.indexOf(event.key)];\n            insert(text);\n            pos.start = ++pos.end;\n            restore(pos);\n        }\n    }\n    function handleTabCharacters(event) {\n        if (event.key === \"Tab\") {\n            preventDefault(event);\n            if (event.shiftKey) {\n                const before = beforeCursor();\n                let [padding, start,] = findPadding(before);\n                if (padding.length > 0) {\n                    const pos = save();\n                    // Remove full length tab or just remaining padding\n                    const len = Math.min(options.tab.length, padding.length);\n                    restore({ start, end: start + len });\n                    document.execCommand(\"delete\");\n                    pos.start -= len;\n                    pos.end -= len;\n                    restore(pos);\n                }\n            }\n            else {\n                insert(options.tab);\n            }\n        }\n    }\n    function handleJumpToBeginningOfLine(event) {\n        if (event.key === \"ArrowLeft\" && event.metaKey) {\n            preventDefault(event);\n            const before = beforeCursor();\n            let [padding, start, end] = findPadding(before);\n            if (before.endsWith(padding)) {\n                if (event.shiftKey) {\n                    const pos = save();\n                    restore({ start, end: pos.end }); // Select from line start.\n                }\n                else {\n                    restore({ start, end: start }); // Jump to line start.\n                }\n            }\n            else {\n                if (event.shiftKey) {\n                    const pos = save();\n                    restore({ start: end, end: pos.end }); // Select from beginning of text.\n                }\n                else {\n                    restore({ start: end, end }); // Jump to beginning of text.\n                }\n            }\n        }\n    }\n    function handleUndoRedo(event) {\n        if (isUndo(event)) {\n            preventDefault(event);\n            at--;\n            const record = history[at];\n            if (record) {\n                editor.innerHTML = record.html;\n                restore(record.pos);\n            }\n            if (at < 0)\n                at = 0;\n        }\n        if (isRedo(event)) {\n            preventDefault(event);\n            at++;\n            const record = history[at];\n            if (record) {\n                editor.innerHTML = record.html;\n                restore(record.pos);\n            }\n            if (at >= history.length)\n                at--;\n        }\n    }\n    function recordHistory() {\n        if (!focus)\n            return;\n        const html = editor.innerHTML;\n        const pos = save();\n        const lastRecord = history[at];\n        if (lastRecord) {\n            if (lastRecord.html === html\n                && lastRecord.pos.start === pos.start\n                && lastRecord.pos.end === pos.end)\n                return;\n        }\n        at++;\n        history[at] = { html, pos };\n        history.splice(at + 1);\n        const maxHistory = 300;\n        if (at > maxHistory) {\n            at = maxHistory;\n            history.splice(0, 1);\n        }\n    }\n    function handlePaste(event) {\n        preventDefault(event);\n        const text = (event.originalEvent || event).clipboardData.getData(\"text/plain\");\n        const pos = save();\n        insert(text);\n        highlight(editor);\n        restore({ start: pos.end + text.length, end: pos.end + text.length });\n    }\n    function visit(editor, visitor) {\n        const queue = [];\n        if (editor.firstChild)\n            queue.push(editor.firstChild);\n        let el = queue.pop();\n        while (el) {\n            if (visitor(el) === \"stop\")\n                break;\n            if (el.nextSibling)\n                queue.push(el.nextSibling);\n            if (el.firstChild)\n                queue.push(el.firstChild);\n            el = queue.pop();\n        }\n    }\n    function isCtrl(event) {\n        return event.metaKey || event.ctrlKey;\n    }\n    function isUndo(event) {\n        return isCtrl(event) && !event.shiftKey && event.code === \"KeyZ\";\n    }\n    function isRedo(event) {\n        return isCtrl(event) && event.shiftKey && event.code === \"KeyZ\";\n    }\n    function insert(text) {\n        text = text\n            .replace(/&/g, \"&amp;\")\n            .replace(/</g, \"&lt;\")\n            .replace(/>/g, \"&gt;\")\n            .replace(/\"/g, \"&quot;\")\n            .replace(/'/g, \"&#039;\");\n        document.execCommand(\"insertHTML\", false, text);\n    }\n    function debounce(cb, wait) {\n        let timeout = 0;\n        return (...args) => {\n            clearTimeout(timeout);\n            timeout = window.setTimeout(() => cb(...args), wait);\n        };\n    }\n    function findPadding(text) {\n        // Find beginning of previous line.\n        let i = text.length - 1;\n        while (i >= 0 && text[i] !== \"\\n\")\n            i--;\n        i++;\n        // Find padding of the line.\n        let j = i;\n        while (j < text.length && /[ \\t]/.test(text[j]))\n            j++;\n        return [text.substring(i, j) || \"\", i, j];\n    }\n    function toString() {\n        return editor.textContent || \"\";\n    }\n    function preventDefault(event) {\n        event.preventDefault();\n    }\n    return {\n        updateOptions(options) {\n            options = Object.assign(Object.assign({}, options), options);\n        },\n        updateCode(code) {\n            editor.textContent = code;\n            highlight(editor);\n        },\n        onUpdate(cb) {\n            callback = cb;\n        },\n        toString,\n        destroy() {\n            for (let [type, fn] of listeners) {\n                editor.removeEventListener(type, fn);\n            }\n        },\n    };\n}\n","/**\n * Prism: Lightweight, robust, elegant syntax highlighting\n * MIT license http://www.opensource.org/licenses/mit-license.php/\n * @author Lea Verou http://lea.verou.me\n */\n\n// Private helper vars\nvar lang = /\\blang(?:uage)?-([\\w-]+)\\b/i;\nvar uniqueId = 0;\n\nvar _\nexport default _ = {\n\tcodeTag: 'code',\n\n\tutil: {\n\t\tencode: function encode(tokens) {\n\t\t\tif (tokens instanceof Token) {\n\t\t\t\treturn new Token(tokens.type, encode(tokens.content), tokens.alias);\n\t\t\t} else if (Array.isArray(tokens)) {\n\t\t\t\treturn tokens.map(encode);\n\t\t\t} else {\n\t\t\t\treturn tokens.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/\\u00a0/g, ' ');\n\t\t\t}\n\t\t},\n\n\t\ttype: function (o) {\n\t\t\treturn Object.prototype.toString.call(o).slice(8, -1);\n\t\t},\n\n\t\tobjId: function (obj) {\n\t\t\tif (!obj['__id']) {\n\t\t\t\tObject.defineProperty(obj, '__id', { value: ++uniqueId });\n\t\t\t}\n\t\t\treturn obj['__id'];\n\t\t},\n\n\t\t// Deep clone a language definition (e.g. to extend it)\n\t\tclone: function deepClone(o, visited) {\n\t\t\tvar clone, id, type = _.util.type(o);\n\t\t\tvisited = visited || {};\n\n\t\t\tswitch (type) {\n\t\t\t\tcase 'Object':\n\t\t\t\t\tid = _.util.objId(o);\n\t\t\t\t\tif (visited[id]) {\n\t\t\t\t\t\treturn visited[id];\n\t\t\t\t\t}\n\t\t\t\t\tclone = {};\n\t\t\t\t\tvisited[id] = clone;\n\n\t\t\t\t\tfor (var key in o) {\n\t\t\t\t\t\tif (o.hasOwnProperty(key)) {\n\t\t\t\t\t\t\tclone[key] = deepClone(o[key], visited);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\treturn clone;\n\n\t\t\t\tcase 'Array':\n\t\t\t\t\tid = _.util.objId(o);\n\t\t\t\t\tif (visited[id]) {\n\t\t\t\t\t\treturn visited[id];\n\t\t\t\t\t}\n\t\t\t\t\tclone = [];\n\t\t\t\t\tvisited[id] = clone;\n\n\t\t\t\t\to.forEach(function (v, i) {\n\t\t\t\t\t\tclone[i] = deepClone(v, visited);\n\t\t\t\t\t});\n\n\t\t\t\t\treturn clone;\n\n\t\t\t\tdefault:\n\t\t\t\t\treturn o;\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Returns the Prism language of the given element set by a `language-xxxx` or `lang-xxxx` class.\n\t\t *\n\t\t * If no language is set for the element or the element is `null` or `undefined`, `none` will be returned.\n\t\t *\n\t\t * @param {Element} element\n\t\t * @returns {string}\n\t\t */\n\t\tgetLanguage: function (element) {\n\t\t\twhile (element && !lang.test(element.className)) {\n\t\t\t\telement = element.parentElement;\n\t\t\t}\n\t\t\tif (element) {\n\t\t\t\treturn (element.className.match(lang) || [, 'none'])[1].toLowerCase();\n\t\t\t}\n\t\t\treturn 'none';\n\t\t}\n\t},\n\n\tlanguages: {\n\t\textend: function (id, redef) {\n\t\t\tvar lang = _.util.clone(_.languages[id]);\n\n\t\t\tfor (var key in redef) {\n\t\t\t\tlang[key] = redef[key];\n\t\t\t}\n\n\t\t\treturn lang;\n\t\t},\n\n\t\t/**\n\t\t * Insert a token before another token in a language literal\n\t\t * As this needs to recreate the object (we cannot actually insert before keys in object literals),\n\t\t * we cannot just provide an object, we need an object and a key.\n\t\t * @param inside The key (or language id) of the parent\n\t\t * @param before The key to insert before.\n\t\t * @param insert Object with the key/value pairs to insert\n\t\t * @param root The object that contains `inside`. If equal to Prism.languages, it can be omitted.\n\t\t */\n\t\tinsertBefore: function (inside, before, insert, root) {\n\t\t\troot = root || _.languages;\n\t\t\tvar grammar = root[inside];\n\t\t\tvar ret = {};\n\n\t\t\tfor (var token in grammar) {\n\t\t\t\tif (grammar.hasOwnProperty(token)) {\n\n\t\t\t\t\tif (token == before) {\n\t\t\t\t\t\tfor (var newToken in insert) {\n\t\t\t\t\t\t\tif (insert.hasOwnProperty(newToken)) {\n\t\t\t\t\t\t\t\tret[newToken] = insert[newToken];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Do not insert token which also occur in insert. See #1525\n\t\t\t\t\tif (!insert.hasOwnProperty(token)) {\n\t\t\t\t\t\tret[token] = grammar[token];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar old = root[inside];\n\t\t\troot[inside] = ret;\n\n\t\t\t// Update references in other language definitions\n\t\t\t_.languages.DFS(_.languages, function(key, value) {\n\t\t\t\tif (value === old && key != inside) {\n\t\t\t\t\tthis[key] = ret;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn ret;\n\t\t},\n\n\t\t// Traverse a language definition with Depth First Search\n\t\tDFS: function DFS(o, callback, type, visited) {\n\t\t\tvisited = visited || {};\n\n\t\t\tvar objId = _.util.objId;\n\n\t\t\tfor (var i in o) {\n\t\t\t\tif (o.hasOwnProperty(i)) {\n\t\t\t\t\tcallback.call(o, i, o[i], type || i);\n\n\t\t\t\t\tvar property = o[i],\n\t\t\t\t\t    propertyType = _.util.type(property);\n\n\t\t\t\t\tif (propertyType === 'Object' && !visited[objId(property)]) {\n\t\t\t\t\t\tvisited[objId(property)] = true;\n\t\t\t\t\t\tDFS(property, callback, null, visited);\n\t\t\t\t\t}\n\t\t\t\t\telse if (propertyType === 'Array' && !visited[objId(property)]) {\n\t\t\t\t\t\tvisited[objId(property)] = true;\n\t\t\t\t\t\tDFS(property, callback, i, visited);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\tplugins: {},\n\n\thighlightElement: function(element, callback) {\n\t\t// Find language\n\t\tvar language = _.util.getLanguage(element);\n\t\tvar grammar = _.languages[language];\n\n\t\t// Set language on the element, if not present\n\t\telement.className = element.className.replace(lang, '').replace(/\\s+/g, ' ') + ' language-' + language;\n\n\t\t// Set language on the parent, for styling\n\t\tvar parent = element.parentNode;\n\t\tif (parent && parent.nodeName.toLowerCase() === 'pre') {\n\t\t\tparent.className = parent.className.replace(lang, '').replace(/\\s+/g, ' ') + ' language-' + language;\n\t\t}\n\n\t\tvar code = element.textContent;\n\n\t\tvar env = {\n\t\t\telement: element,\n\t\t\tlanguage: language,\n\t\t\tgrammar: grammar,\n\t\t\tcode: code\n\t\t};\n\n\t\tfunction insertHighlightedCode(highlightedCode) {\n\t\t\tenv.highlightedCode = highlightedCode;\n\n\t\t\t_.hooks.run('before-insert', env);\n\n\t\t\tenv.element.innerHTML = env.highlightedCode;\n\n\t\t\t_.hooks.run('after-highlight', env);\n\t\t\t_.hooks.run('complete', env);\n\t\t\tcallback && callback.call(env.element);\n\t\t}\n\n\t\t_.hooks.run('before-sanity-check', env);\n\n\t\tif (!env.code) {\n\t\t\t_.hooks.run('complete', env);\n\t\t\tcallback && callback.call(env.element);\n\t\t\treturn;\n\t\t}\n\n\t\t_.hooks.run('before-highlight', env);\n\n\t\tif (!env.grammar) {\n\t\t\tinsertHighlightedCode(_.util.encode(env.code));\n\t\t\treturn;\n\t\t}\n\n\t\tinsertHighlightedCode(_.highlight(env.code, env.grammar, env.language));\n\t},\n\n\thighlight: function (text, grammar, language) {\n\t\tvar env = {\n\t\t\tcode: text,\n\t\t\tgrammar: grammar,\n\t\t\tlanguage: language\n\t\t};\n\t\t_.hooks.run('before-tokenize', env);\n\t\tenv.tokens = _.tokenize(env.code, env.grammar);\n\t\t_.hooks.run('after-tokenize', env);\n\t\treturn Token.stringify(_.util.encode(env.tokens), env.language);\n\t},\n\n\ttokenize: function(text, grammar) {\n\t\tvar rest = grammar.rest;\n\t\tif (rest) {\n\t\t\tfor (var token in rest) {\n\t\t\t\tgrammar[token] = rest[token];\n\t\t\t}\n\n\t\t\tdelete grammar.rest;\n\t\t}\n\n\t\tvar tokenList = new LinkedList();\n\t\taddAfter(tokenList, tokenList.head, text);\n\n\t\tmatchGrammar(text, tokenList, grammar, tokenList.head, 0);\n\n\t\treturn toArray(tokenList);\n\t},\n\n\thooks: {\n\t\tall: {},\n\n\t\tadd: function (name, callback) {\n\t\t\tvar hooks = _.hooks.all;\n\n\t\t\thooks[name] = hooks[name] || [];\n\n\t\t\thooks[name].push(callback);\n\t\t},\n\n\t\trun: function (name, env) {\n\t\t\tvar callbacks = _.hooks.all[name];\n\n\t\t\tif (!callbacks || !callbacks.length) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tfor (var i=0, callback; callback = callbacks[i++];) {\n\t\t\t\tcallback(env);\n\t\t\t}\n\t\t}\n\t},\n\n\tToken: Token\n};\n\nfunction Token(type, content, alias, matchedStr, greedy) {\n\tthis.type = type;\n\tthis.content = content;\n\tthis.alias = alias;\n\t// Copy of the full string this token was created from\n\tthis.length = (matchedStr || '').length|0;\n\tthis.greedy = !!greedy;\n}\n\nToken.stringify = function stringify(o, language) {\n\tif (typeof o == 'string') {\n\t\treturn o;\n\t}\n\tif (Array.isArray(o)) {\n\t\tvar s = '';\n\t\to.forEach(function (e) {\n\t\t\ts += stringify(e, language);\n\t\t});\n\t\treturn s;\n\t}\n\n\tvar env = {\n\t\ttype: o.type,\n\t\tcontent: stringify(o.content, language),\n\t\ttag: 'span',\n\t\tclasses: ['token', o.type],\n\t\tattributes: {},\n\t\tlanguage: language\n\t};\n\n\tvar aliases = o.alias;\n\tif (aliases) {\n\t\tif (Array.isArray(aliases)) {\n\t\t\tArray.prototype.push.apply(env.classes, aliases);\n\t\t} else {\n\t\t\tenv.classes.push(aliases);\n\t\t}\n\t}\n\n\t_.hooks.run('wrap', env);\n\n\tvar attributes = '';\n\tfor (var name in env.attributes) {\n\t\tattributes += ' ' + name + '=\"' + (env.attributes[name] || '').replace(/\"/g, '&quot;') + '\"';\n\t}\n\n\treturn '<' + env.tag + ' class=\"' + env.classes.join(' ') + '\"' + attributes + '>' + env.content + '</' + env.tag + '>';\n};\n\n/**\n * @param {string} text\n * @param {LinkedList<string | Token>} tokenList\n * @param {any} grammar\n * @param {LinkedListNode<string | Token>} startNode\n * @param {number} startPos\n * @param {boolean} [oneshot=false]\n * @param {string} [target]\n */\nfunction matchGrammar(text, tokenList, grammar, startNode, startPos, oneshot, target) {\n\tfor (var token in grammar) {\n\t\tif (!grammar.hasOwnProperty(token) || !grammar[token]) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tvar patterns = grammar[token];\n\t\tpatterns = Array.isArray(patterns) ? patterns : [patterns];\n\n\t\tfor (var j = 0; j < patterns.length; ++j) {\n\t\t\tif (target && target == token + ',' + j) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar pattern = patterns[j],\n\t\t\t\tinside = pattern.inside,\n\t\t\t\tlookbehind = !!pattern.lookbehind,\n\t\t\t\tgreedy = !!pattern.greedy,\n\t\t\t\tlookbehindLength = 0,\n\t\t\t\talias = pattern.alias;\n\n\t\t\tif (greedy && !pattern.pattern.global) {\n\t\t\t\t// Without the global flag, lastIndex won't work\n\t\t\t\tvar flags = pattern.pattern.toString().match(/[imsuy]*$/)[0];\n\t\t\t\tpattern.pattern = RegExp(pattern.pattern.source, flags + 'g');\n\t\t\t}\n\n\t\t\tpattern = pattern.pattern || pattern;\n\n\t\t\tfor ( // iterate the token list and keep track of the current token/string position\n\t\t\t\tvar currentNode = startNode.next, pos = startPos;\n\t\t\t\tcurrentNode !== tokenList.tail;\n\t\t\t\tpos += currentNode.value.length, currentNode = currentNode.next\n\t\t\t) {\n\n\t\t\t\tvar str = currentNode.value;\n\n\t\t\t\tif (tokenList.length > text.length) {\n\t\t\t\t\t// Something went terribly wrong, ABORT, ABORT!\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (str instanceof Token) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tvar removeCount = 1; // this is the to parameter of removeBetween\n\n\t\t\t\tif (greedy && currentNode != tokenList.tail.prev) {\n\t\t\t\t\tpattern.lastIndex = pos;\n\t\t\t\t\tvar match = pattern.exec(text);\n\t\t\t\t\tif (!match) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar from = match.index + (lookbehind && match[1] ? match[1].length : 0);\n\t\t\t\t\tvar to = match.index + match[0].length;\n\t\t\t\t\tvar p = pos;\n\n\t\t\t\t\t// find the node that contains the match\n\t\t\t\t\tp += currentNode.value.length;\n\t\t\t\t\twhile (from >= p) {\n\t\t\t\t\t\tcurrentNode = currentNode.next;\n\t\t\t\t\t\tp += currentNode.value.length;\n\t\t\t\t\t}\n\t\t\t\t\t// adjust pos (and p)\n\t\t\t\t\tp -= currentNode.value.length;\n\t\t\t\t\tpos = p;\n\n\t\t\t\t\t// the current node is a Token, then the match starts inside another Token, which is invalid\n\t\t\t\t\tif (currentNode.value instanceof Token) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\t// find the last node which is affected by this match\n\t\t\t\t\tfor (\n\t\t\t\t\t\tvar k = currentNode;\n\t\t\t\t\t\tk !== tokenList.tail && (p < to || (typeof k.value === 'string' && !k.prev.value.greedy));\n\t\t\t\t\t\tk = k.next\n\t\t\t\t\t) {\n\t\t\t\t\t\tremoveCount++;\n\t\t\t\t\t\tp += k.value.length;\n\t\t\t\t\t}\n\t\t\t\t\tremoveCount--;\n\n\t\t\t\t\t// replace with the new match\n\t\t\t\t\tstr = text.slice(pos, p);\n\t\t\t\t\tmatch.index -= pos;\n\t\t\t\t} else {\n\t\t\t\t\tpattern.lastIndex = 0;\n\n\t\t\t\t\tvar match = pattern.exec(str);\n\t\t\t\t}\n\n\t\t\t\tif (!match) {\n\t\t\t\t\tif (oneshot) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (lookbehind) {\n\t\t\t\t\tlookbehindLength = match[1] ? match[1].length : 0;\n\t\t\t\t}\n\n\t\t\t\tvar from = match.index + lookbehindLength,\n\t\t\t\t\tmatch = match[0].slice(lookbehindLength),\n\t\t\t\t\tto = from + match.length,\n\t\t\t\t\tbefore = str.slice(0, from),\n\t\t\t\t\tafter = str.slice(to);\n\n\t\t\t\tvar removeFrom = currentNode.prev;\n\n\t\t\t\tif (before) {\n\t\t\t\t\tremoveFrom = addAfter(tokenList, removeFrom, before);\n\t\t\t\t\tpos += before.length;\n\t\t\t\t}\n\n\t\t\t\tremoveRange(tokenList, removeFrom, removeCount);\n\n\t\t\t\tvar wrapped = new Token(token, inside ? _.tokenize(match, inside) : match, alias, match, greedy);\n\t\t\t\tcurrentNode = addAfter(tokenList, removeFrom, wrapped);\n\n\t\t\t\tif (after) {\n\t\t\t\t\taddAfter(tokenList, currentNode, after);\n\t\t\t\t}\n\n\n\t\t\t\tif (removeCount > 1)\n\t\t\t\t\tmatchGrammar(text, tokenList, grammar, currentNode.prev, pos, true, token + ',' + j);\n\n\t\t\t\tif (oneshot)\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n}\n\n/**\n * @typedef LinkedListNode\n * @property {T} value\n * @property {LinkedListNode<T> | null} prev The previous node.\n * @property {LinkedListNode<T> | null} next The next node.\n * @template T\n */\n\n/**\n * @template T\n */\nfunction LinkedList() {\n\t/** @type {LinkedListNode<T>} */\n\tvar head = { value: null, prev: null, next: null };\n\t/** @type {LinkedListNode<T>} */\n\tvar tail = { value: null, prev: head, next: null };\n\thead.next = tail;\n\n\t/** @type {LinkedListNode<T>} */\n\tthis.head = head;\n\t/** @type {LinkedListNode<T>} */\n\tthis.tail = tail;\n\tthis.length = 0;\n}\n\n/**\n * Adds a new node with the given value to the list.\n * @param {LinkedList<T>} list\n * @param {LinkedListNode<T>} node\n * @param {T} value\n * @returns {LinkedListNode<T>} The added node.\n * @template T\n */\nfunction addAfter(list, node, value) {\n\t// assumes that node != list.tail && values.length >= 0\n\tvar next = node.next;\n\n\tvar newNode = { value: value, prev: node, next: next };\n\tnode.next = newNode;\n\tnext.prev = newNode;\n\tlist.length++;\n\n\treturn newNode;\n}\n/**\n * Removes `count` nodes after the given node. The given node will not be removed.\n * @param {LinkedList<T>} list\n * @param {LinkedListNode<T>} node\n * @param {number} count\n * @template T\n */\nfunction removeRange(list, node, count) {\n\tvar next = node.next;\n\tfor (var i = 0; i < count && next !== list.tail; i++) {\n\t\tnext = next.next;\n\t}\n\tnode.next = next;\n\tnext.prev = node;\n\tlist.length -= i;\n}\n/**\n * @param {LinkedList<T>} list\n * @returns {T[]}\n * @template T\n */\nfunction toArray(list) {\n\tvar array = [];\n\tvar node = list.head.next;\n\twhile (node !== list.tail) {\n\t\tarray.push(node.value);\n\t\tnode = node.next;\n\t}\n\treturn array;\n}\n","import Prism from './prism-core'\n\n/**\n * Plugin name which is used as a class name for <pre> which is activating the plugin\n * @type {String}\n */\nvar PLUGIN_NAME = 'line-numbers';\n\n/**\n * Regular expression used for determining line breaks\n * @type {RegExp}\n */\nvar NEW_LINE_EXP = /\\n(?!$)/g;\n\n/**\n * Resizes line numbers spans according to height of line of code\n * @param {Element} element <pre> element\n */\nvar _resizeElement = function (element) {\n\tvar codeStyles = getStyles(element);\n\tvar whiteSpace = codeStyles['white-space'];\n\n\tif (whiteSpace === 'pre-wrap' || whiteSpace === 'pre-line') {\n\t\tvar codeElement = element.querySelector(Prism.codeTag);\n\t\tvar lineNumbersWrapper = element.querySelector('.line-numbers-rows');\n\t\tvar lineNumberSizer = element.querySelector('.line-numbers-sizer');\n\t\tvar codeLines = codeElement.textContent.split(NEW_LINE_EXP);\n\n\t\tif (!lineNumberSizer) {\n\t\t\tlineNumberSizer = document.createElement('span');\n\t\t\tlineNumberSizer.className = 'line-numbers-sizer';\n\n\t\t\tcodeElement.appendChild(lineNumberSizer);\n\t\t}\n\n\t\tlineNumberSizer.style.display = 'block';\n\n\t\tcodeLines.forEach(function (line, lineNumber) {\n\t\t\tlineNumberSizer.textContent = line || '\\n';\n\t\t\tvar lineSize = lineNumberSizer.getBoundingClientRect().height;\n\t\t\tlineNumbersWrapper.children[lineNumber].style.height = lineSize + 'px';\n\t\t});\n\n\t\tlineNumberSizer.textContent = '';\n\t\tlineNumberSizer.style.display = 'none';\n\t}\n};\n\n/**\n * Returns style declarations for the element\n * @param {Element} element\n */\nvar getStyles = function (element) {\n\tif (!element) {\n\t\treturn null;\n\t}\n\n\treturn window.getComputedStyle ? getComputedStyle(element) : (element.currentStyle || null);\n};\n\nPrism.hooks.add('complete', function (env) {\n\tif (!env.code) {\n\t\treturn;\n\t}\n\n\tvar code = env.element;\n\tvar pre = code.parentNode;\n\n\t// works only for <code> wrapped inside <pre> (not inline)\n\tif (!pre || !/pre/i.test(pre.nodeName)) {\n\t\treturn;\n\t}\n\n\t// Abort if line numbers already exists\n\tif (code.querySelector('.line-numbers-rows')) {\n\t\treturn;\n\t}\n\n\tvar addLineNumbers = false;\n\tvar lineNumbersRegex = /(?:^|\\s)line-numbers(?:\\s|$)/;\n\n\tfor (var element = code; element; element = element.parentNode) {\n\t\tif (lineNumbersRegex.test(element.className)) {\n\t\t\taddLineNumbers = true;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\t// only add line numbers if <code> or one of its ancestors has the `line-numbers` class\n\tif (!addLineNumbers) {\n\t\treturn;\n\t}\n\n\t// Remove the class 'line-numbers' from the <code>\n\tcode.className = code.className.replace(lineNumbersRegex, ' ');\n\t// Add the class 'line-numbers' to the <pre>\n\tif (!lineNumbersRegex.test(pre.className)) {\n\t\tpre.className += ' line-numbers';\n\t}\n\n\tvar match = env.code.match(NEW_LINE_EXP);\n\tvar linesNum = match ? match.length + 1 : 1;\n\tvar lineNumbersWrapper;\n\n\tvar lines = new Array(linesNum + 1).join('<span></span>');\n\n\tlineNumbersWrapper = document.createElement('span');\n\tlineNumbersWrapper.setAttribute('aria-hidden', 'true');\n\tlineNumbersWrapper.className = 'line-numbers-rows';\n\tlineNumbersWrapper.innerHTML = lines;\n\n\tif (pre.hasAttribute('data-start')) {\n\t\tpre.style.counterReset = 'linenumber ' + (parseInt(pre.getAttribute('data-start'), 10) - 1);\n\t}\n\n\tenv.element.appendChild(lineNumbersWrapper);\n\n\t_resizeElement(pre);\n\n\tPrism.hooks.run('line-numbers', env);\n});\n\nPrism.hooks.add('line-numbers', function (env) {\n\tenv.plugins = env.plugins || {};\n\tenv.plugins.lineNumbers = true;\n});\n\n/**\n * Global exports\n */\nPrism.plugins.lineNumbers = {\n\t/**\n\t * Update line numbers after resizing the text area by mouse\n\t * @param {Element} element pre element\n\t * @return {undefined}\n\t */\n\tupdateLineNumbers: function(element) {\n\t\t_resizeElement(element);\n\t},\n\t/**\n\t * Get node for provided line number\n\t * @param {Element} element pre element\n\t * @param {Number} number line number\n\t * @return {Element|undefined}\n\t */\n\tgetLine: function (element, number) {\n\t\tif (element.tagName !== 'PRE' || !element.classList.contains(PLUGIN_NAME)) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar lineNumberRows = element.querySelector('.line-numbers-rows');\n\t\tvar lineNumberStart = parseInt(element.getAttribute('data-start'), 10) || 1;\n\t\tvar lineNumberEnd = lineNumberStart + (lineNumberRows.children.length - 1);\n\n\t\tif (number < lineNumberStart) {\n\t\t\tnumber = lineNumberStart;\n\t\t}\n\t\tif (number > lineNumberEnd) {\n\t\t\tnumber = lineNumberEnd;\n\t\t}\n\n\t\tvar lineIndex = number - lineNumberStart;\n\n\t\treturn lineNumberRows.children[lineIndex];\n\t}\n};\n","import Prism from './prism-core'\n\nvar MATCH_ALL_CLASS = /(?:^|\\s)match-braces(?:\\s|$)/;\n\nvar BRACE_HOVER_CLASS = /(?:^|\\s)brace-hover(?:\\s|$)/;\nvar BRACE_SELECTED_CLASS = /(?:^|\\s)brace-selected(?:\\s|$)/;\n\nvar NO_BRACE_HOVER_CLASS = /(?:^|\\s)no-brace-hover(?:\\s|$)/;\nvar NO_BRACE_SELECT_CLASS = /(?:^|\\s)no-brace-select(?:\\s|$)/;\n\nvar PARTNER = {\n\t'(': ')',\n\t'[': ']',\n\t'{': '}',\n};\n\nvar NAMES = {\n\t'(': 'brace-round',\n\t'[': 'brace-square',\n\t'{': 'brace-curly',\n};\n\nvar LEVEL_WARP = 12;\n\nvar pairIdCounter = 0;\n\nvar BRACE_ID_PATTERN = /^(pair-\\d+-)(open|close)$/;\n\n/**\n * Returns the brace partner given one brace of a brace pair.\n *\n * @param {HTMLElement} brace\n * @returns {HTMLElement}\n */\nfunction getPartnerBrace(brace) {\n\tvar match = BRACE_ID_PATTERN.exec(brace.id);\n\treturn brace.parentElement.querySelector('#' + match[1] + (match[2] == 'open' ? 'close' : 'open'));\n}\n\n/**\n * @this {HTMLElement}\n */\nfunction hoverBrace() {\n\tfor (var parent = this.parentElement; parent; parent = parent.parentElement) {\n\t\tif (NO_BRACE_HOVER_CLASS.test(parent.className)) {\n\t\t\treturn;\n\t\t}\n\t}\n\n\t[this, getPartnerBrace(this)].forEach(function (ele) {\n\t\tele.className = (ele.className.replace(BRACE_HOVER_CLASS, ' ') + ' brace-hover').replace(/\\s+/g, ' ');\n\t});\n}\n/**\n * @this {HTMLElement}\n */\nfunction leaveBrace() {\n\t[this, getPartnerBrace(this)].forEach(function (ele) {\n\t\tele.className = ele.className.replace(BRACE_HOVER_CLASS, ' ');\n\t});\n}\n/**\n * @this {HTMLElement}\n */\nfunction clickBrace() {\n\tfor (var parent = this.parentElement; parent; parent = parent.parentElement) {\n\t\tif (NO_BRACE_SELECT_CLASS.test(parent.className)) {\n\t\t\treturn;\n\t\t}\n\t}\n\n\t[this, getPartnerBrace(this)].forEach(function (ele) {\n\t\tele.className = (ele.className.replace(BRACE_SELECTED_CLASS, ' ') + ' brace-selected').replace(/\\s+/g, ' ');\n\t});\n}\n\nPrism.hooks.add('complete', function (env) {\n\n\t/** @type {HTMLElement} */\n\tvar code = env.element;\n\tvar pre = code.parentElement;\n\n\tif (!pre || pre.tagName != 'PRE') {\n\t\treturn;\n\t}\n\n\t// find the braces to match\n\t/** @type {string[]} */\n\tvar toMatch = [];\n\tfor (var ele = code; ele; ele = ele.parentElement) {\n\t\tif (MATCH_ALL_CLASS.test(ele.className)) {\n\t\t\ttoMatch.push('(', '[', '{');\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif (toMatch.length == 0) {\n\t\t// nothing to match\n\t\treturn;\n\t}\n\n\tif (!pre.__listenerAdded) {\n\t\t// code blocks might be highlighted more than once\n\t\tpre.addEventListener('mousedown', function removeBraceSelected() {\n\t\t\t// the code element might have been replaced\n\t\t\tvar code = pre.querySelector(Prism.codeTag);\n\t\t\tArray.prototype.slice.call(code.querySelectorAll('.brace-selected')).forEach(function (element) {\n\t\t\t\telement.className = element.className.replace(BRACE_SELECTED_CLASS, ' ');\n\t\t\t});\n\t\t});\n\t\tObject.defineProperty(pre, '__listenerAdded', { value: true });\n\t}\n\n\t/** @type {HTMLSpanElement[]} */\n\tvar punctuation = Array.prototype.slice.call(code.querySelectorAll('span.token.punctuation'));\n\n\t/** @type {{ index: number, open: boolean, element: HTMLElement }[]} */\n\tvar allBraces = [];\n\n\ttoMatch.forEach(function (open) {\n\t\tvar close = PARTNER[open];\n\t\tvar name = NAMES[open];\n\n\t\t/** @type {[number, number][]} */\n\t\tvar pairs = [];\n\t\t/** @type {number[]} */\n\t\tvar openStack = [];\n\n\t\tfor (var i = 0; i < punctuation.length; i++) {\n\t\t\tvar element = punctuation[i];\n\t\t\tif (element.childElementCount == 0) {\n\t\t\t\tvar text = element.textContent;\n\t\t\t\tif (text === open) {\n\t\t\t\t\tallBraces.push({ index: i, open: true, element: element });\n\t\t\t\t\telement.className += ' ' + name;\n\t\t\t\t\telement.className += ' brace-open';\n\t\t\t\t\topenStack.push(i);\n\t\t\t\t} else if (text === close) {\n\t\t\t\t\tallBraces.push({ index: i, open: false, element: element });\n\t\t\t\t\telement.className += ' ' + name;\n\t\t\t\t\telement.className += ' brace-close';\n\t\t\t\t\tif (openStack.length) {\n\t\t\t\t\t\tpairs.push([i, openStack.pop()]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tpairs.forEach(function (pair) {\n\t\t\tvar pairId = 'pair-' + (pairIdCounter++) + '-';\n\n\t\t\tvar openEle = punctuation[pair[0]];\n\t\t\tvar closeEle = punctuation[pair[1]];\n\n\t\t\topenEle.id = pairId + 'open';\n\t\t\tcloseEle.id = pairId + 'close';\n\n\t\t\t[openEle, closeEle].forEach(function (ele) {\n\t\t\t\tele.addEventListener('mouseenter', hoverBrace);\n\t\t\t\tele.addEventListener('mouseleave', leaveBrace);\n\t\t\t\tele.addEventListener('click', clickBrace);\n\t\t\t});\n\t\t});\n\t});\n\n\tvar level = 0;\n\tallBraces.sort(function (a, b) { return a.index - b.index; });\n\tallBraces.forEach(function (brace) {\n\t\tif (brace.open) {\n\t\t\tbrace.element.className += ' brace-level-' + (level % LEVEL_WARP + 1);\n\t\t\tlevel++;\n\t\t} else {\n\t\t\tlevel = Math.max(0, level - 1);\n\t\t\tbrace.element.className += ' brace-level-' + (level % LEVEL_WARP + 1);\n\t\t}\n\t});\n\n});\n","import Prism from './prism-core'\n\nPrism.languages.graphviz = {\n  comment: [{\n    pattern: /\\/\\/(?:[^\\r\\n\\\\]|\\\\(?:\\r\\n?|\\n|(?![\\r\\n])))*|\\/\\*[\\s\\S]*?(?:\\*\\/|$)/,\n    greedy: true\n  }, {\n    pattern: /(^|[^\\\\:])\\/\\/.*/,\n    lookbehind: !0,\n    greedy: !0\n  }],\n  string: {\n    pattern: /([\"'])(?:\\\\(?:\\r\\n|[\\s\\S])|(?!\\1)[^\\\\\\r\\n])*\\1/,\n    greedy: !0\n  },\n  'class-name': {\n    pattern: /(\\b(?:digraph|graph)\\s+)\\w+/,\n    lookbehind: true\n  },\n  keyword: /\\b(?:digraph|graph|node|edge)\\b/,\n  property: /\\b(?:Damping|URL|area|arrowhead|arrowsize|arrowtail|aspect|bb|bgcolor|center|charset|clusterrank|color|colorscheme|comment|compound|concentrate|constraint|decorate|defaultdist|dim|dimen|dir|diredgeconstraints|distortion|dpi|edgeURL|edgehref|edgetarget|edgetooltip|epsilon|esep|fillcolor|fixedsize|fontcolor|fontname|fontnames|fontpath|fontsize|group|headURL|headclip|headhref|headlabel|headport|headtarget|headtooltip|height|href|id|image|imagepath|imagescale|label|labelURL|labelangle|labeldistance|labelfloat|labelfontcolor|labelfontname|labelfontsize|labelhref|labeljust|labelloc|labeltarget|labeltooltip|landscape|layer|layerlistsep|layers|layerselect|layersep|layout|len|levels|levelsgap|lhead|lheight|lp|ltail|lwidth|margin|maxiter|mclimit|mindist|minlen|mode|model|mosek|nodesep|nojustify|normalize|nslimit|nslimit1|ordering|orientation|outputorder|overlap|overlap_scaling|pack|packmode|pad|page|pagedir|pencolor|penwidth|peripheries|pin|pos|quadtree|quantum|rank|rankdir|ranksep|ratio|rects|regular|remincross|repulsiveforce|resolution|root|rotate|rotation|samehead|sametail|samplepoints|scale|searchsize|sep|shape|shapefile|showboxes|sides|size|skew|smoothing|sortv|splines|start|style|stylesheet|tail_lp|tailURL|tailclip|tailhref|taillabel|tailport|tailtarget|tailtooltip|target|tooltip|truecolor|vertices|viewport|voro_margin|weight|width|xlabel)\\b/,\n  constant: /\\b(?:dot|neato|fdp|sfdp|twopi|circo|osage|patchwork|LR|RL|TB|BT|box|polygon|ellipse|oval|circle|point|egg|triangle|plaintext|plain|diamond|trapezium|parallelogram|house|pentagon|hexagon|septagon|octagon|doublecircle|doubleoctagon|tripleoctagon|invtriangle|invtrapezium|invhouse|Mdiamond|Msquare|Mcircle|rect|rectangle|square|star|none|underline|cylinder|note|tab|folder|box3d|component|promoter|cds|terminator|utr|primersite|restrictionsite|fivepoverhang|threepoverhang|noverhang|assembly|signature|insulator|ribosite|rnastab|proteasesite|proteinstab|rpromoter|rarrow|larrow|lpromoter|solid|dashed|dotted|bold|rounded|diagonals|filled|striped|wedged)\\b/,\n  boolean: /\\b(?:true|yes|false|no)\\b/,\n  number: /\\b0x[\\da-f]+\\b|(?:\\b\\d+\\.?\\d*|\\B\\.\\d+)(?:e[+-]?\\d+)?/i,\n  operator: /->|--|=/,\n  punctuation: /[{}[\\];(),.:]/\n}\n","import { CodeJar } from './codejar/codejar'\nimport Prism from './prism/prism-core'\nimport lightTheme from './prism/prism-light.css'\nimport lineNumbersStyle from './prism/prism-line-numbers.css'\nimport matchBracesStyle from './prism/prism-match-braces.css'\nimport mainStyle from './script-editor.css'\nimport './prism/prism-line-numbers'\nimport './prism/prism-match-braces'\nimport './prism/prism-graphviz'\n\nconst features = ['line-numbers', 'match-braces', 'rainbow-braces']\nconst connectedKey = Symbol('connecte')\nconst valueKey = Symbol('value')\nconst tabKey = Symbol('tab')\nconst classKey = Symbol('class')\nconst jarKey = Symbol('jar')\nconst widthKey = Symbol('width')\nconst heightKey = Symbol('height')\nconst mousedownKey = Symbol('mousedown')\nconst mouseupKey = Symbol('mouseup')\nlet template, pendingAllLineNumbersUpdate\n\nPrism.codeTag = 'div'\n\nfunction getTemplate () {\n  if (!template) {\n    template = document.createElement('template')\n    template.innerHTML = `<style>\n${lightTheme}\n${lineNumbersStyle}\n${matchBracesStyle}\n${mainStyle}\n</style>\n<pre id=source-wrapper><div id=source></div></pre>`\n  }\n  return template\n}\n\nfunction triggerEvent (element, type, detail) {\n  element.dispatchEvent(new CustomEvent(type, { detail }))\n}\n\nfunction getFeatureClasses (element) {\n  return element.className\n    .trim()\n    .split(/\\s+/)\n    .filter(feature => features.includes(feature))\n    .join(' ')\n}\n\nfunction hasChangedFeatureClass (oldValue, newValue) {\n  const oldClasses = oldValue ? oldValue.trim().split(/\\s+/) : []\n  const newClasses = newValue.trim().split(/\\s+/)\n  return features.some(feature =>\n    oldClasses.includes(feature) !== newClasses.includes(feature))\n}\n\nfunction normalizeLineBreaks (value) {\n  return value.replace(/\\r?\\n/, '\\n')\n}\n\nfunction createEditor (element) {\n  const ownerRoot = element.shadowRoot\n  const source = ownerRoot.getElementById('source')\n  const featureClasses = getFeatureClasses(element)\n  source.className = `language-graphviz ${featureClasses}`\n  const jar = element[jarKey] = CodeJar(source, Prism.highlightElement, { tab: element.tab, ownerRoot })\n  updateEditor(element)\n  jar.onUpdate(newCode => {\n    newCode = normalizeLineBreaks(newCode)\n    if (element.value !== newCode) {\n      element[valueKey] = newCode\n      triggerEvent(element, 'input', newCode)\n    }\n  })\n}\n\nfunction destroyEditor (element) {\n  element[jarKey].destroy()\n  element[jarKey] = null\n}\n\nfunction rebuildEditor (element) {\n  destroyEditor(element)\n  createEditor(element)\n}\n\nfunction updateEditor (element) {\n  element[jarKey].updateCode(element.value)\n}\n\nfunction configureEditor (element) {\n  element[jarKey].updateOptions({ tab: element.tab })\n}\n\nclass GraphvizScriptEditorElement extends HTMLElement {\n  constructor () {\n    super()\n    this[valueKey] = ''\n    this[tabKey] = '  '\n    this[classKey] = ''\n    this.attachShadow({ mode: 'open' })\n    this.shadowRoot.appendChild(getTemplate().content.cloneNode(true))\n  }\n\n  get value () { return this[valueKey] }\n  set value (value) { this.setAttribute('value', value) }\n\n  get tab () { return this[tabKey] }\n  set tab (value) { this.setAttribute('tab', value) }\n\n  get className () { return this[classKey] }\n  set className (value) { this.setAttribute('class', value) }\n\n  attributeChangedCallback (name, oldValue, newValue) {\n    switch (name) {\n      case 'value':\n        this[valueKey] = normalizeLineBreaks(newValue)\n        if (this[connectedKey]) updateEditor(this)\n        break\n      case 'tab':\n        this[tabKey] = newValue\n        if (this[connectedKey]) configureEditor(this)\n        break\n      case 'class':\n        this[classKey] = newValue\n        if (this[connectedKey] && hasChangedFeatureClass(oldValue, newValue)) rebuildEditor(this)\n        break\n    }\n  }\n\n  connectedCallback () {\n    registerEvents(this)\n    createEditor(this)\n    this[connectedKey] = true\n  }\n\n  disconnectedCallback () {\n    destroyEditor(this)\n    unregisterEvents(this)\n    this[connectedKey] = false\n  }\n\n  static get observedAttributes () { return ['value', 'tab', 'class'] }\n}\n\nfunction rememberSize (element) {\n  element[widthKey] = element.clientWidth\n  element[heightKey] = element.clientHeight\n}\n\nfunction updateLineNumbers (element) {\n  const newWidth = element.clientWidth\n  const newHeight = element.clientHeight\n  if (newWidth !== element[widthKey] || newHeight !== element[heightKey]) {\n    Prism.plugins.lineNumbers.updateLineNumbers(element.shadowRoot.getElementById('source-wrapper'))\n    element[widthKey] = newWidth\n    element[heightKey] = newHeight\n  }\n}\n\nfunction registerEvents (element) {\n  const mousedown = element[mousedownKey] = () => rememberSize(element)\n  const mouseup = element[mouseupKey] = () => updateLineNumbers(element)\n  element.addEventListener('mousedown', mousedown)\n  element.addEventListener('mouseup', mouseup)\n}\n\nfunction unregisterEvents (element) {\n  element.removeEventListener('mouseup', element[mouseupKey])\n  element.removeEventListener('mousedown', element[mousedownKey])\n}\n\nfunction updateAllLineNumbers () {\n  clearTimeout(pendingAllLineNumbersUpdate)\n  const editors = document.querySelectorAll('graphviz-script-editor.line-numbers')\n  for (const editor of editors) updateLineNumbers(editor)\n}\n\nfunction scheduleUpdateAllLineNumbers () {\n  if (pendingAllLineNumbersUpdate) clearTimeout(pendingAllLineNumbersUpdate)\n  pendingAllLineNumbersUpdate = setTimeout(updateAllLineNumbers, 300)\n}\n\nwindow.addEventListener('resize', scheduleUpdateAllLineNumbers)\n\ncustomElements.define('graphviz-script-editor', GraphvizScriptEditorElement)\n"],"names":["graphKey","Symbol","scaleKey","delayWorkerLoading","window","graphvizWebComponent","renderer","rendererUrl","wasmFolder","ensureConfiguration","getRenderer","Worker","requestRendering","element","script","receiveResult","addEventListener","localWasmFolder","getAttribute","console","warn","postMessage","graph","undefined","closeRendering","removeEventListener","triggerEvent","type","detail","dispatchEvent","CustomEvent","applyScale","svg","shadowRoot","children","scale","style","transform","transformOrigin","showImage","innerHTML","updateGraph","data","error","message","trim","showError","GraphvizGraphElement","HTMLElement","[object Object]","super","this","attachShadow","mode","value","setAttribute","name","oldValue","newValue","Promise","resolve","reject","observedAttributes","CodeJar","editor","highlight","opt","options","Object","assign","tab","ownerRoot","getSelection","ownerDocument","Error","callback","prev","listeners","history","at","focus","isFirefox","navigator","userAgent","toLowerCase","indexOf","outline","overflowWrap","overflowY","resize","whiteSpace","debounceHighlight","debounce","pos","save","restore","recording","shouldRecord","event","isUndo","isRedo","key","startsWith","debounceRecordHistory","recordHistory","on","fn","push","s","start","end","dir","visit","el","anchorNode","focusNode","anchorOffset","focusOffset","nodeType","Node","TEXT_NODE","nodeValue","length","startNode","endNode","startOffset","endOffset","current","len","setBaseAndExtent","beforeCursor","r0","getRangeAt","r","document","createRange","selectNodeContents","setEnd","startContainer","toString","afterCursor","setStart","endContainer","html","lastRecord","splice","visitor","queue","firstChild","pop","nextSibling","isCtrl","metaKey","ctrlKey","shiftKey","code","insert","text","replace","execCommand","cb","wait","timeout","args","clearTimeout","setTimeout","findPadding","i","j","test","substring","textContent","preventDefault","defaultPrevented","before","after","padding","newLinePadding","handleNewLine","Math","min","handleTabCharacters","endsWith","handleJumpToBeginningOfLine","open","close","codeAfter","includes","substr","handleSelfClosingCharacters","record","handleUndoRedo","isComposing","_event","originalEvent","clipboardData","getData","handlePaste","customElements","define","_","lang","uniqueId","codeTag","util","encode","tokens","Token","content","alias","Array","isArray","map","o","prototype","call","slice","objId","obj","defineProperty","clone","deepClone","visited","id","hasOwnProperty","forEach","v","getLanguage","className","parentElement","match","languages","extend","redef","insertBefore","inside","root","grammar","ret","token","newToken","old","DFS","property","propertyType","plugins","highlightElement","language","parent","parentNode","nodeName","env","insertHighlightedCode","highlightedCode","hooks","run","tokenize","stringify","rest","tokenList","LinkedList","addAfter","head","matchGrammar","startPos","oneshot","target","patterns","pattern","lookbehind","greedy","lookbehindLength","global","flags","RegExp","source","currentNode","next","tail","str","removeCount","lastIndex","exec","from","index","to","p","k","removeFrom","removeRange","wrapped","list","array","node","toArray","all","add","callbacks","matchedStr","newNode","count","e","tag","classes","attributes","aliases","apply","join","NEW_LINE_EXP","_resizeElement","getStyles","codeElement","querySelector","Prism","lineNumbersWrapper","lineNumberSizer","codeLines","split","createElement","appendChild","display","line","lineNumber","lineSize","getBoundingClientRect","height","getComputedStyle","currentStyle","pre","addLineNumbers","lineNumbersRegex","linesNum","lines","hasAttribute","counterReset","parseInt","lineNumbers","updateLineNumbers","getLine","number","tagName","classList","contains","lineNumberRows","lineNumberStart","lineNumberEnd","lineIndex","MATCH_ALL_CLASS","BRACE_HOVER_CLASS","BRACE_SELECTED_CLASS","NO_BRACE_HOVER_CLASS","NO_BRACE_SELECT_CLASS","PARTNER","(","[","{","NAMES","pairIdCounter","BRACE_ID_PATTERN","getPartnerBrace","brace","hoverBrace","ele","leaveBrace","clickBrace","toMatch","__listenerAdded","querySelectorAll","punctuation","allBraces","pairs","openStack","childElementCount","pair","pairId","openEle","closeEle","level","sort","a","b","max","graphviz","comment","string","class-name","keyword","constant","boolean","operator","features","connectedKey","valueKey","tabKey","classKey","jarKey","widthKey","heightKey","mousedownKey","mouseupKey","template","pendingAllLineNumbersUpdate","normalizeLineBreaks","createEditor","getElementById","featureClasses","filter","feature","getFeatureClasses","jar","updateEditor","onUpdate","newCode","destroyEditor","destroy","updateCode","GraphvizScriptEditorElement","cloneNode","updateOptions","oldClasses","newClasses","some","hasChangedFeatureClass","rebuildEditor","mousedown","clientWidth","clientHeight","rememberSize","mouseup","registerEvents","newWidth","newHeight","updateAllLineNumbers","editors"],"mappings":"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"}